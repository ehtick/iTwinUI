import{r as e,a as qe,B as ae,c as ne,u as A,f as ke,o as U,m as xe,F as We,e as ve,K as Pe,n as Be,y as He,E as je,z as Ke,b as Y}from"./index-B_nhM74P.js";import{L as Re}from"./Label-DDazfaAg.js";import{I as Fe}from"./Input-CVMRJSIe.js";import{T as Ge}from"./Textarea-HXffXxh1.js";import{I as Le}from"./Icon-bEjb6gKd.js";import{I as ce}from"./InputWithDecorations-PGj6z2hX.js";import{M as Ue}from"./MenuExtraContent-DeNxkr_R.js";import{a as Ye,I as fe,b as Je,A as Qe,S as le}from"./Select-Dv5idYYO.js";import{T as Xe}from"./Text-CUeksER-.js";import{S as Ze}from"./SvgCaretDownSmall-w2OtLSXJ.js";import{u as _e}from"./useContainerWidth-Ow2UNjLJ.js";import{L as et}from"./List-BRDp86or.js";import{u as tt}from"./useVirtualScroll-Ba_8IYsv.js";import{L as re}from"./ListItem-BmW-tdy4.js";import{S as rt}from"./SvgCheckmark-DXpr0reG.js";const me=e.forwardRef((a,s)=>{let{children:f,startIcon:i,status:r,className:o,iconProps:n,contentProps:u,...t}=a,m=i??(r&&qe[r]()),x=i!==null&&!!m;return e.createElement(ae,{className:ne("iui-status-message",o),"data-iui-status":r,ref:s,...t},x?e.createElement(Le,{"aria-hidden":!0,...n},m):null,e.createElement(ae,u,f))}),at=e.forwardRef((a,s)=>{let{label:f,disabled:i,required:r,status:o,message:n,icon:u,isLabelInline:t,children:m,className:x,style:R,statusMessage:b,inputId:y,labelId:E,...c}=a;return e.createElement(ae,{className:ne("iui-input-grid",x),"data-iui-status":o,"data-iui-label-placement":t?"inline":void 0,style:R,ref:s,...c},f&&e.createElement(Re,{as:y&&a.as!=="label"?"label":"div",required:r,disabled:i,htmlFor:y,id:E},f),m,b||n&&e.createElement(me,{startIcon:u,status:o},n))}),pe=e.createContext(void 0),J=e.createContext(void 0),lt=e.forwardRef((a,s)=>{let{className:f,children:i,disabled:r,isOpen:o,...n}=a;return e.createElement(Le,{as:"span",ref:s,className:ne("iui-end-icon",{"iui-disabled":r,"iui-open":o},f),...n},i??e.createElement(Ze,{"aria-hidden":!0}))}),nt=e.forwardRef((a,s)=>{let{selectedItems:f=[],...i}=a;return e.createElement(Ye,{ref:s,tags:f,...i})}),it=e.forwardRef((a,s)=>{let{selectTags:f,size:i,style:r,...o}=a,{isOpen:n,id:u,focusedIndex:t,setFocusedIndex:m,enableVirtualization:x,multiple:R,onClickHandler:b,popover:y,show:E,hide:c}=A(J),{inputRef:ie,menuRef:w,optionsExtraInfo:C}=A(pe),be=ke(ie,y.refs.setReference,s),k=U(t??-1),ge=V=>{var d,h;return((h=(d=w.current)==null?void 0:d.querySelector(`[data-iui-index="${V}"]`))==null?void 0:h.id)??""},Q=e.useCallback(V=>{var h,Z,$,_,z,L,W,P,T,N;let d=Object.keys(C).length??0;if(!V.altKey)switch(V.key){case"ArrowDown":{if(V.preventDefault(),!n)return E();if(d===0)return;if(k.current===-1){let S=(h=w.current)==null?void 0:h.querySelector("[data-iui-index]");return m(Number((S==null?void 0:S.getAttribute("data-iui-index"))??0))}if(x&&!(($=(Z=w.current)==null?void 0:Z.querySelector(`[data-iui-index="${k.current}"]`))!=null&&$.nextElementSibling))return;let M=k.current;do{let S=(_=w.current)==null?void 0:_.querySelector(`[data-iui-index="${M}"]`),v=(S==null?void 0:S.nextElementSibling)??((z=w.current)==null?void 0:z.querySelector("[data-iui-index]"));if(M=Number(v==null?void 0:v.getAttribute("data-iui-index")),v)return m(M)}while(M!==k.current);break}case"ArrowUp":{if(V.preventDefault(),!n)return E();if(d===0||x&&!((W=(L=w.current)==null?void 0:L.querySelector(`[data-iui-index="${k.current}"]`))!=null&&W.previousElementSibling))return;if(k.current===-1)return m(((P=Object.values(C))==null?void 0:P[d-1].__originalIndex)??-1);let M=k.current;do{let S=(T=w.current)==null?void 0:T.querySelector(`[data-iui-index="${M}"]`),v=(S==null?void 0:S.previousElementSibling)??((N=w.current)==null?void 0:N.querySelector("[data-iui-index]:last-of-type"));if(M=Number(v==null?void 0:v.getAttribute("data-iui-index")),v)return m(M)}while(M!==k.current);break}case"Enter":V.preventDefault(),n?k.current>-1&&(b==null||b(k.current)):E();break;case"Escape":V.preventDefault(),c();break;case"Tab":c();break}},[m,x,k,n,w,b,C,E,c]),X=e.useRef(!1),F=e.useCallback(()=>{X.current=n},[n]),O=e.useCallback(()=>{X.current?c():E(),X.current=!1},[c,E]),[j,q]=_e();return e.createElement(e.Fragment,null,e.createElement(Fe,{ref:be,"aria-expanded":n,"aria-activedescendant":n&&t!=null&&t>-1?ge(t):void 0,role:"combobox","aria-controls":n?`${u}-list`:void 0,"aria-autocomplete":"list",spellCheck:!1,autoCapitalize:"none",autoCorrect:"off",style:{...R&&{paddingInlineStart:q+18},...r},size:i,...y.getReferenceProps({...o,onPointerDown:xe(a.onPointerDown,F),onClick:xe(a.onClick,O),onKeyDown:xe(a.onKeyDown,Q)})}),R&&f?e.createElement(nt,{ref:j,selectedItems:f}):null)}),st=e.forwardRef((a,s)=>{let{className:f,status:i,message:r,children:o,...n}=a,{id:u}=A(J);return e.createElement(at,{className:f,status:i,statusMessage:typeof r=="string"?e.createElement(me,{status:i},r):e.isValidElement(r)&&e.cloneElement(r,{status:i}),ref:s,...n,id:u},e.createElement(fe,null,o))});let ot=a=>{let{children:s,...f}=a,{filteredOptions:i,getMenuItem:r,focusedIndex:o}=A(J),{menuRef:n}=A(pe),u=e.useMemo(()=>{let b=0;for(let y=0;y<Math.min(5,i.length);y++)i[y].sublabel&&b++;return b>=Math.min(3,i.length)},[i]),t=e.useMemo(()=>{var y;let b=(y=n.current)==null?void 0:y.querySelector(`[data-iui-index="${o}"]`);return b?Number(b.getAttribute("data-iui-filtered-index")??o):o},[o,n]),{virtualizer:m,css:x}=tt({count:i.length||1,getScrollElement:()=>n.current,estimateSize:()=>u?48:36,gap:-1});ve(()=>{m.scrollToIndex(t)},[m,t]);let R=e.useCallback(b=>{let y=i.length>0?r(i[b.index],b.index):s;return e.cloneElement(y,{key:b.key,ref:m.measureElement,"data-iui-virtualizer":"item",style:{width:"100%",transform:`translateY(${b.start}px)`}})},[i,r,s,m.measureElement]);return e.createElement("div",{style:{display:"contents"}},e.createElement(Pe,{css:x},e.createElement(ae,{as:"div","data-iui-virtualizer":"root",...f,style:{minBlockSize:m.getTotalSize(),...a.style}},e.createElement("slot",null))),e.createElement(e.Fragment,null,m.getVirtualItems().map(b=>R(b))))};const ut=e.forwardRef((a,s)=>{let{className:f,children:i,style:r,portal:o=!0,...n}=a,{id:u,enableVirtualization:t,popover:m}=A(J),{menuRef:x}=A(pe),R=ke(m.refs.setFloating,s,x);return m.open&&e.createElement(We,{portal:o},e.createElement(et,{as:"div",className:ne("iui-menu",f),id:`${u}-list`,role:"listbox",ref:R,...m.getFloatingProps({style:t?{maxInlineSize:0,...r}:r,...n})},t?e.createElement(ot,null,i):i))}),dt=e.memo(e.forwardRef((a,s)=>{let{children:f,isSelected:i,disabled:r,value:o,onClick:n,sublabel:u,size:t=u?"large":"default",startIcon:m,endIcon:x,role:R="option",index:b,...y}=a,{focusedIndex:E,enableVirtualization:c}=A(J),w=ke(s,C=>{!c&&E===b&&(C==null||C.scrollIntoView({block:"nearest"}))});return e.createElement(re,{as:"div",actionable:!0,size:t,active:i,disabled:r,focused:E===b,ref:w,onClick:()=>n==null?void 0:n(),role:R,tabIndex:R==="presentation"?void 0:-1,"aria-selected":i,"aria-disabled":r,"data-iui-index":b,...y},m&&e.createElement(re.Icon,{as:"span","aria-hidden":!0},m),e.createElement(re.Content,null,f,u&&e.createElement(re.Description,null,u)),x||i&&e.createElement(re.Icon,{as:"span","aria-hidden":!0},x??e.createElement(rt,null)))}));let D=(a,s)=>s&&(Array.isArray(a)||a==null),ct=(a,s)=>!s,Se=(a,s)=>a.id?a.id:typeof a.value=="string"||typeof a.value=="number"?`${s}-option-${a.label.toString().replace(/\s/g,"-")}`:`${s}-option-${a.label.replace(/\s/g,"-")}`;const we=e.forwardRef((a,s)=>{var Ve;let f=Be(),i=e.useCallback((l,p)=>l.filter(g=>g.label.toLowerCase().includes(p.toLowerCase())),[]),{options:r,value:o,onChange:n,filterFunction:u=i,inputProps:t,endIconProps:m,dropdownMenuProps:{middleware:x,...R}={},emptyStateMessage:b="No options found",itemRenderer:y,enableVirtualization:E=!1,multiple:c=!1,onShow:ie,onHide:w,id:C=t!=null&&t.id?`iui-${t.id}-cb`:f,defaultValue:be,clearFilterOnOptionToggle:k=!0,...ge}=a,Q=e.useRef(null),X=e.useRef(null),F=U(n),O=U(r),j=U(u),q=e.useMemo(()=>{let l={};return r.forEach((p,g)=>{l[Se(p,C)]={__originalIndex:g}}),l},[C,r]),V=e.useCallback(l=>{if(l!==void 0){if(!D(l,c))return r.findIndex(p=>p.value===l);{let p=[];return l==null||l.forEach(g=>{let I=r.findIndex(B=>B.value===g);I>-1&&p.push(I)}),p}}},[c,r]),[d,h]=He(V(be)??(c?[]:-1),V(o)),Z=e.useRef(o);ve(()=>{o!==Z.current&&(Z.current=o,o===void 0&&(D(d,c)?h([]):h(-1)))},[c,d,h,o]);let[$,_]=e.useState(!1),[z,L]=e.useState(-1),W=U(ie),P=U(w),T=e.useCallback(()=>{var l;_(!0),(l=W.current)==null||l.call(W)},[W]),N=e.useCallback(()=>{var l;_(!1),(l=P.current)==null||l.call(P)},[P]);ve(()=>{var l,p;$?((l=Q.current)==null||l.focus(),D(d,c)||L(d??-1)):(L(-1),D(d,c)?v(""):v(d>=0?((p=O.current[d])==null?void 0:p.label)??"":""),Ie(!1))},[$,c,O,d]);let M=e.useRef(r);e.useEffect(()=>{r!==M.current&&(M.current=r,l());function l(){var p;D(d,c)?L(-1):L(d),!D(d,c)&&!$&&v(d>=0?(p=r[d])==null?void 0:p.label:"")}},[r,$,c,d]);let[S,v]=e.useState(((Ve=t==null?void 0:t.value)==null?void 0:Ve.toString())??""),[he,Ie]=e.useState(!1),se=e.useMemo(()=>{var l;return he?(l=j.current)==null?void 0:l.call(j,r,S):r},[j,S,r,he]),[Ne,De]=e.useState(""),Te=e.useCallback(l=>{var g;let{value:p}=l.currentTarget;v(p),T(),Ie(!0),z!=-1&&L(-1),(g=t==null?void 0:t.onChange)==null||g.call(t,l)},[z,t,T]),ee=e.useCallback(l=>D(d,c)?d.includes(l):d===l,[c,d]),Me=e.useCallback((l,p)=>{if(D(d,c))return p==="added"?[...d,l]:d==null?void 0:d.filter(g=>g!==l)},[d,c]),ye=e.useCallback((l,p,g)=>{var I,B,G,H;ct(F.current,c)?(B=F.current)==null||B.call(F,(I=O.current[l])==null?void 0:I.value):p&&g&&((H=F.current)==null||H.call(F,g==null?void 0:g.map(Ce=>{var oe;return(oe=O.current[Ce])==null?void 0:oe.value}),{value:(G=O.current[l])==null?void 0:G.value,type:p}))},[c,F,O]),K=e.useCallback(l=>{var p,g;if((p=Q.current)==null||p.focus({preventScroll:!0}),!((g=O.current[l])!=null&&g.disabled))if(c){let I=ee(l)?"removed":"added",B=Me(l,I);if(B==null)return;h(B),ye(l,I,B),De(B.map(G=>{var H;return(H=O.current[G])==null?void 0:H.label}).filter(Boolean).join(", ")),k&&(v(""),Ie(!1))}else h(l),N(),ye(l)},[O,c,ee,Me,h,ye,k,N]),Ee=e.useCallback((l,p)=>{let g=Se(l,C),{__originalIndex:I}=q[g],{icon:B,startIcon:G,label:H,...Ce}=l,oe=G??B,ue=y?y(l,{isFocused:z===I,isSelected:ee(I),index:I,id:g}):null;return ue?e.cloneElement(ue,{onClick:te=>{var $e,ze;K(I),(ze=($e=ue.props).onClick)==null||ze.call($e,te)},focused:z===I,"data-iui-index":I,"data-iui-filtered-index":p,ref:je(ue.props.ref,te=>{!E&&z===I&&(te==null||te.scrollIntoView({block:"nearest"}))})}):e.createElement(dt,{key:g,id:g,startIcon:oe,...Ce,isSelected:ee(I),onClick:()=>{K(I)},index:I,"data-iui-filtered-index":p},H)},[E,z,C,ee,y,K,q]),Ae=e.useMemo(()=>e.createElement(e.Fragment,null,e.isValidElement(b)?b:e.createElement(Ue,null,e.createElement(Xe,{isMuted:!0},b))),[b]),Oe=Ke({visible:$,onVisibleChange:l=>l?T():N(),matchWidth:!0,middleware:{size:{maxHeight:"var(--iui-menu-max-height)"},...x},closeOnOutsideClick:!0,interactions:{click:!1,focus:!0}});return e.createElement(pe.Provider,{value:e.useMemo(()=>({inputRef:Q,menuRef:X,optionsExtraInfo:q}),[q])},e.createElement(J.Provider,{value:e.useMemo(()=>({id:C,isOpen:$,focusedIndex:z,setFocusedIndex:L,onClickHandler:K,enableVirtualization:E,filteredOptions:se,getMenuItem:Ee,multiple:c,popover:Oe,show:T,hide:N}),[E,se,z,Ee,K,N,C,$,c,Oe,T])},e.createElement(st,{ref:s,disabled:t==null?void 0:t.disabled,...ge},e.createElement(it,{value:S,disabled:t==null?void 0:t.disabled,...t,onChange:Te,"aria-describedby":[c?`${C}-selected-live`:void 0,t==null?void 0:t["aria-describedby"]].filter(Boolean).join(" "),selectTags:D(d,c)?d==null?void 0:d.map(l=>{let p=r[l],g=Se(p,C),{__originalIndex:I}=q[g];return e.createElement(Je,{key:p.label,label:p.label,onRemove:t!=null&&t.disabled?void 0:()=>{K(I),N()}})}).filter(Boolean):void 0}),e.createElement(lt,{...m,disabled:t==null?void 0:t.disabled,isOpen:$}),c?e.createElement(Qe,{text:Ne,id:`${C}-selected-live`}):null),e.createElement(ut,{as:"div",...R},se.length>0&&!E?se.map(Ee):Ae)))}),Vt=e.forwardRef((a,s)=>{let{children:f,className:i,labelPlacement:r,...o}=a,n=ft(f);return e.createElement(ae,{className:ne("iui-input-grid",i),"data-iui-label-placement":r,ref:s,...o},n)});let ft=a=>{let{labelId:s,inputId:f,messageId:i}=mt(a);return e.useMemo(()=>e.Children.map(a,r=>e.isValidElement(r)?r.type===Re||r.type==="label"?Y(r,o=>({...o.props,htmlFor:o.props.htmlFor||f,id:o.props.id||s})):r.type===me?Y(r,o=>({...o.props,id:o.props.id||i})):de(r)||r.type===ce||r.type===fe?pt(r,{labelId:s,inputId:f,messageId:i}):r:r),[a,f,s,i])},mt=a=>{let s=Be(),f,i,r,o=!1,n=!1,u=t=>{var m;if(e.isValidElement(t)){if(t.type===we)return((m=t.props.inputProps)==null?void 0:m.id)||`${s}--input`;if(t.type!==le)return t.props.id||`${s}--input`}};return e.Children.forEach(a,t=>{e.isValidElement(t)&&((t.type===Re||t.type==="label")&&(o=!0,f||(f=t.props.id||`${s}--label`)),t.type===me&&(r||(r=t.props.id||`${s}--message`)),t.type===ce||t.type===fe?e.Children.forEach(t.props.children,m=>{de(m)&&(i||(i=u(m)))}):de(t)&&(i||(i=u(t))),t.type===le&&(n=!0))}),{labelId:n?f:void 0,inputId:o&&!n?i:void 0,messageId:r}},pt=(a,{labelId:s,inputId:f,messageId:i})=>{let r=(n={})=>{let u=[n["aria-describedby"],i].filter(Boolean).join(" ");return{...n,...a.type!==le&&{id:n.id||f},"aria-describedby":(u==null?void 0:u.trim())||void 0}},o=n=>n.type===we?Y(n,u=>({inputProps:r(u.props.inputProps)})):n.type===le?Y(n,u=>({triggerProps:{"aria-labelledby":s,...r(u.props.triggerProps)}})):Y(n,u=>r(u.props));return a.type===ce||a.type===fe?Y(a,n=>({children:e.Children.map(n.props.children,u=>e.isValidElement(u)&&de(u)?o(u):u)})):o(a)},de=a=>e.isValidElement(a)&&(a.type==="input"||a.type==="textarea"||a.type==="select"||a.type===Fe||a.type===Ge||a.type===ce.Input||a.type===le||a.type===we);export{we as C,Vt as I,me as S};
